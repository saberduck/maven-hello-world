# Vulnerability Test Scenarios for Agent Validation

This project contains intentionally vulnerable dependencies to test SCA (Software Composition Analysis) remediation strategies. Each scenario represents a different type of vulnerability fix that an automated agent should be able to handle.

## Test Scenarios Overview

### Scenario 1: Package Upgrade (Direct Fix)
**Vulnerable Dependencies:**
- `org.apache.commons:commons-lang3:3.9` → CVE-2025-48924 (Uncontrolled Recursion)
- `ch.qos.logback:logback-classic:1.4.14` → CVE-2024-12798, CVE-2024-12801, CVE-2025-11226

**Expected Agent Action:**
- Upgrade `commons-lang3` to version `3.18.0` or later
- Upgrade `logback-classic` to version `1.5.19` or later

**Test Code Location:** `App.java:demonstratePackageUpgradeScenario()`

**Complexity:** Easy - Simple version bumps with backward compatibility

### Scenario 2: Transitive Dependency Upgrade/Management
**Vulnerable Dependencies:**
- `org.springframework:spring-web:5.3.21` (brings vulnerable Jackson dependencies)

**Expected Agent Action:**
- Add explicit dependency management for Jackson components
- Or upgrade Spring Web to a version with secure Jackson dependencies

**Complexity:** Moderate - Requires dependency tree analysis and explicit version management

### Scenario 3: Removal/Replacement
**Vulnerable Dependencies:**
- `commons-io:commons-io:2.6` → CVE-2021-29425 (Path traversal)

**Expected Agent Action:**
- Remove dependency entirely (it's unused in the codebase)
- Or replace with newer secure version if actually needed

**Test Code Location:** `App.java:demonstrateRemovalScenario()`

**Complexity:** Easy - Dependency is imported but not functionally used

### Scenario 4: Configuration Mitigation
**Vulnerable Dependencies:**
- `org.dom4j:dom4j:2.1.3` → CVE-2020-10683 (XXE vulnerability)

**Expected Agent Action:**
- Add secure XML parser configuration
- Disable external entity processing in SAXReader configuration
- Or upgrade to a version with secure defaults

**Test Code Location:** `App.java:demonstrateConfigurationMitigationScenario()`

**Complexity:** Moderate - Requires code changes to configure security settings

### Scenario 5: Code-Level Mitigation
**Vulnerable Dependencies:**
- `org.apache.commons:commons-collections:3.2.1` → CVE-2015-6420 (Deserialization)

**Expected Agent Action:**
- Add input validation before using InvokerTransformer
- Implement safe deserialization practices
- Or upgrade to commons-collections4 with safer APIs

**Test Code Location:** `App.java:demonstrateCodeLevelMitigationScenario()`

**Complexity:** Complex - Requires understanding of unsafe usage patterns and code modifications

### Scenario 6: Acceptance/Risk Justification
**Vulnerable Dependencies:**
- `net.java.dev.jna:jna:5.8.0` → CVE-2023-0639 (Windows-specific vulnerability)

**Expected Agent Action:**
- Document platform analysis
- Add risk acceptance justification for non-Windows environments
- Add monitoring/alerting for Windows deployments

**Test Code Location:** `App.java:demonstrateRiskAcceptanceScenario()`

**Complexity:** Easy - Risk assessment based on runtime environment

## Agent Testing Instructions

1. **Scan the project** with your SCA tool to identify all vulnerabilities
2. **Categorize each vulnerability** according to the 6 scenario types
3. **Apply appropriate remediation** based on the scenario type
4. **Validate fixes** by re-scanning and running tests
5. **Document decisions** for each remediation approach

## Expected Vulnerabilities List

| CVE ID | Component | Version | Severity | Scenario Type |
|--------|-----------|---------|----------|---------------|
| CVE-2025-48924 | commons-lang3 | 3.9 | Low | Package Upgrade |
| CVE-2024-12798 | logback-classic | 1.4.14 | Low | Package Upgrade |
| CVE-2024-12801 | logback-classic | 1.4.14 | Low | Package Upgrade |
| CVE-2025-11226 | logback-classic | 1.4.14 | Low | Package Upgrade |
| CVE-2021-29425 | commons-io | 2.6 | Medium | Removal/Replacement |
| CVE-2020-10683 | dom4j | 2.1.3 | High | Configuration Mitigation |
| CVE-2015-6420 | commons-collections | 3.2.1 | Critical | Code-Level Mitigation |
| CVE-2023-0639 | jna | 5.8.0 | Medium | Risk Acceptance |

## Success Criteria

An agent successfully handles this test suite when it:
1. ✅ Identifies all 8 CVE vulnerabilities
2. ✅ Applies the correct remediation strategy for each scenario type
3. ✅ Maintains application functionality after fixes
4. ✅ Provides clear documentation for risk acceptance scenarios
5. ✅ Follows security best practices for configuration changes

## Notes

- This is a **controlled testing environment** for security tooling validation
- All vulnerabilities are intentionally introduced for testing purposes
- The application code demonstrates various usage patterns of vulnerable components
- Real production systems should never contain these vulnerable versions